define(["dialog","report/edit/canvas/chart-setting/axis-text/axis-text-model","report/edit/canvas/chart-setting/axis-text/axis-text-setting-template"],function(a,b,c){return Backbone.View.extend({events:{"click .j-set-axis-text":"getAxisTextList"},initialize:function(a){var c=this;c.model=new b({canvasModel:a.canvasView.model,reportId:a.reportId}),this.model.set("compId",c.$el.find(".j-comp-setting").attr("data-comp-id"))},getAxisTextList:function(){var a=this;a.model.getCompAxis(function(b){a._openAxisTextDialog(b)})},destroy:function(){this.stopListening(),this.model.clear({silent:!0}),delete this.model,this.$el.unbind()},_openAxisTextDialog:function(b){var d,e=this;return $.isEmptyObject(b.indList)?(a.alert("没有指标"),void 0):(d=c.render(b),a.showDialog({title:"坐标轴名字设置",content:d,dialog:{width:400,height:300,resizable:!1,buttons:[{text:"提交",click:function(){e._saveAxisTextInfo($(this))}},{text:"取消",click:function(){$(this).dialog("close")}}]}}),void 0)},_saveAxisTextInfo:function(a){function b(a){var b=0;return b=null===a.match(/[^ -~]/g)?a.length:a.length+a.match(/[^ -~]/g).length}var c=$(".j-axis-text-setting .j-axis-text-item input"),d=$(".j-axis-text-setting .j-axis-text-item .j-error-msg"),e={},f=!0,g=26;d.hide(),c.each(function(){var a=$(this),c=a.val();b(c)>g&&(f=!1,a.next(".j-error-msg").show());var d=a.attr("name");e[d]=c}),f&&this.model.saveAxisTextInfo(e,function(){a.dialog("close"),window.dataInsight.main.canvas.showReport()})}})});