define(["dialog","report/edit/canvas/chart-setting/individuation/individuation-model","report/edit/canvas/chart-setting/individuation/individuation-template"],function(a,b,c){return Backbone.View.extend({events:{"click .j-set-individuation":"getIndividuationData"},initialize:function(a){var c=this;c.model=new b({canvasModel:a.canvasView.model,reportId:a.reportId}),this.model.set("compId",c.$el.find(".j-comp-setting").attr("data-comp-id"))},getIndividuationData:function(){var a=this;a.model.getIndividuationData(function(b){a._openIndividuationDialog(b)})},destroy:function(){this.stopListening(),this.model.clear({silent:!0}),delete this.model,this.$el.unbind()},_bindEvent:function(){var a=$(".j-isShowTitle");a.unbind(),a.change(function(){var a=$(this).is(":checked");a?$(".j-appearance-set-title").show():$(".j-appearance-set-title").hide()})},_openIndividuationDialog:function(b){var d=this,e=c.render(b);a.showDialog({title:"个性化设置",content:e,dialog:{width:340,height:300,resizable:!1,buttons:[{text:"提交",click:function(){d._saveIndividuationInfo($(this))}},{text:"取消",click:function(){$(this).dialog("close")}}]}}),d._bindEvent()},_saveIndividuationInfo:function(a){var b=$(".j-appearance-setting .j-appearance-item"),c={},d={};b.each(function(){var a=$(this).find('input[type="checkbox"]'),b=a.attr("name");"isShowTitle"===b&&a.is(":checked")&&(d.chartTitle=$(".j-appearance-set-title input").val()),d[b]=a.is(":checked")}),c.appearance=JSON.stringify(d),this.model.saveIndividuationInfo(c,function(){a.dialog("close"),window.dataInsight.main.canvas.showReport()})}})});